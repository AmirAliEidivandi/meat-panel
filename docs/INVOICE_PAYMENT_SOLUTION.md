# Ø±Ø§Ù‡â€ŒØ­Ù„ Ù¾Ø±Ø¯Ø§Ø®Øª ÙØ§Ú©ØªÙˆØ± Ø³ÙØ§Ø±Ø´

## ğŸ“‹ Ø®Ù„Ø§ØµÙ‡ Ù…Ø´Ú©Ù„

ÙˆÙ‚ØªÛŒ Ø³ÙØ§Ø±Ø´ Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ `PARTIALLY_DELIVERED` Ù…ÛŒâ€ŒØ±Ø³Ø¯:

- ÙØ§Ú©ØªÙˆØ± ØµØ§Ø¯Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù…Ø´ØªØ±ÛŒ Ø¢Ù¾Ø¯ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø§Ù†Ø¨Ø§Ø± Ø¢Ù¾Ø¯ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯

**Ø³ÙˆØ§Ù„**: Ú†Ú¯ÙˆÙ†Ù‡ Ù…Ø´ØªØ±ÛŒ Ø¨Ø§ÛŒØ¯ ÙØ§Ú©ØªÙˆØ± Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ù†Ø¯ØŸ

## ğŸ¯ Ø±Ø§Ù‡â€ŒØ­Ù„ Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ

### 1. Ù…Ù†Ø·Ù‚ Ù¾Ø±Ø¯Ø§Ø®Øª

**Ú¯Ø²ÛŒÙ†Ù‡ 1: Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„ (Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ø¨Ø§Ø´Ø¯)**

- Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ >= Ù…Ø¨Ù„Øº ÙØ§Ú©ØªÙˆØ± â†’ Ù¾Ø±Ø¯Ø§Ø®Øª Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„
- Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ú©Ø§Ù‡Ø´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯
- ÙˆØ¶Ø¹ÛŒØª ÙØ§Ú©ØªÙˆØ± Ø¨Ù‡ `PAID` ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒÚ©Ù†Ø¯

**Ú¯Ø²ÛŒÙ†Ù‡ 2: Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡ (Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ù†Ø¨Ø§Ø´Ø¯)**

- Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ < Ù…Ø¨Ù„Øº ÙØ§Ú©ØªÙˆØ± â†’ Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡
- Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù‡Ø¯Ø§ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯
- Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚ØŒ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯ Ùˆ Ø³Ù¾Ø³ Ø§Ø² Ø¢Ù† Ú©Ø³Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯

**Ú¯Ø²ÛŒÙ†Ù‡ 3: Ù¾Ø±Ø¯Ø§Ø®Øª ØªØ±Ú©ÛŒØ¨ÛŒ (Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯ÛŒ)**

- Ø§Ø¨ØªØ¯Ø§ Ø§Ø² Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ú©Ø³Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯ (ØªØ§ Ø­Ø¯ Ù…Ù…Ú©Ù†)
- Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Ù‡ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÛŒâ€ŒØ´ÙˆØ¯

### 2. Endpoints Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²

#### 2.1. Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ§Ú©ØªÙˆØ± Ø¨Ø±Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª

```
GET /orders/{orderId}/invoice/payment-info
```

**Response:**

```typescript
{
  order_id: string;
  invoice_id: string;
  invoice_code: number;
  total_amount: number; // Ù…Ø¨Ù„Øº Ú©Ù„ ÙØ§Ú©ØªÙˆØ±
  wallet_balance: number; // Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„
  remaining_amount: number; // Ù…Ø¨Ù„Øº Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Ù‡ (total_amount - wallet_balance)
  can_pay_from_wallet: boolean; // Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„ Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ù†Ø¯ØŸ
  payment_status: "NOT_PAID" | "PARTIALLY_PAID" | "PAID";
  created_at: string;
}
```

#### 2.2. Ù¾Ø±Ø¯Ø§Ø®Øª ÙØ§Ú©ØªÙˆØ± Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„

```
POST /orders/{orderId}/invoice/pay-from-wallet
```

**Request:**

```typescript
{
  amount?: number; // Ø§Ø®ØªÛŒØ§Ø±ÛŒ - Ø§Ú¯Ø± Ù†Ø¨Ø§Ø´Ø¯ØŒ Ú©Ù„ Ù…Ø¨Ù„Øº Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÛŒâ€ŒØ´ÙˆØ¯
}
```

**Response:**

```typescript
{
  success: boolean;
  message: string;
  payment_id: string;
  remaining_amount: number; // Ù…Ø¨Ù„Øº Ø¨Ø§Ù‚ÛŒÙ…Ø§Ù†Ø¯Ù‡ Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø±Ø¯Ø§Ø®Øª
  wallet_balance_after: number; // Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø±Ø¯Ø§Ø®Øª
}
```

#### 2.3. Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ù¾Ø±Ø¯Ø§Ø®Øª ÙØ§Ú©ØªÙˆØ± Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡

```
POST /payments/invoices/{invoiceId}/gateway/zarinpal
POST /payments/invoices/{invoiceId}/gateway/zibal
```

**Request:**

```typescript
{
  amount: number; // Ù…Ø¨Ù„ØºÛŒ Ú©Ù‡ Ø¨Ø§ÛŒØ¯ Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ø´ÙˆØ¯
  gateway: "zarinpal" | "zibal";
}
```

**Response:**

```typescript
{
  payment_transaction_id: string;
  redirect_url: string;
  amount: number;
}
```

#### 2.4. Callback Ù¾Ø±Ø¯Ø§Ø®Øª ÙØ§Ú©ØªÙˆØ±

```
GET /payments/invoices/{invoiceId}/callback/zarinpal
GET /payments/invoices/{invoiceId}/callback/zibal
```

**Query Parameters:**

- `payment_transaction_id`: string
- `Authority` (Ø¨Ø±Ø§ÛŒ Ø²Ø±ÛŒÙ†â€ŒÙ¾Ø§Ù„): string
- `Status` (Ø¨Ø±Ø§ÛŒ Ø²Ø±ÛŒÙ†â€ŒÙ¾Ø§Ù„): string
- `trackId` (Ø¨Ø±Ø§ÛŒ Ø²ÛŒØ¨Ø§Ù„): number

**Response:**

```typescript
{
  success: boolean;
  message: string;
  ref_id: string;
  invoice_id: string;
  order_id: string;
  amount_paid: number;
  wallet_balance_after: number;
}
```

### 3. Flow Ù¾Ø±Ø¯Ø§Ø®Øª

```
1. Ø³ÙØ§Ø±Ø´ Ø¨Ù‡ Ù…Ø±Ø­Ù„Ù‡ PARTIALLY_DELIVERED Ù…ÛŒâ€ŒØ±Ø³Ø¯
   â†“
2. ÙØ§Ú©ØªÙˆØ± ØµØ§Ø¯Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯
   â†“
3. Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ ØµÙØ­Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª ÙØ§Ú©ØªÙˆØ± Ù‡Ø¯Ø§ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯
   â†“
4. Ø³ÛŒØ³ØªÙ… Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯:
   - Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ
   - Ù…Ø¨Ù„Øº ÙØ§Ú©ØªÙˆØ± Ú†Ù‚Ø¯Ø± Ø§Ø³ØªØŸ
   â†“
5. Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ø¨Ø§Ø´Ø¯:
   - Ø¯Ú©Ù…Ù‡ "Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„" Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
   - Ú©Ø§Ø±Ø¨Ø± Ú©Ù„ÛŒÚ© Ù…ÛŒâ€ŒÚ©Ù†Ø¯
   - Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„ Ú©Ø³Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯
   - ÙØ§Ú©ØªÙˆØ± Ø¨Ù‡ PAID ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒÚ©Ù†Ø¯
   â†“
6. Ø§Ú¯Ø± Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ø§ÙÛŒ Ù†Ø¨Ø§Ø´Ø¯:
   - Ø¯Ú©Ù…Ù‡ "Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡" Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
   - Ú©Ø§Ø±Ø¨Ø± Ú©Ù„ÛŒÚ© Ù…ÛŒâ€ŒÚ©Ù†Ø¯
   - Ø¨Ù‡ Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª Ù‡Ø¯Ø§ÛŒØª Ù…ÛŒâ€ŒØ´ÙˆØ¯
   - Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚:
     * Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø§ÙØ²Ø§ÛŒØ´ Ù…ÛŒâ€ŒÛŒØ§Ø¨Ø¯
     * Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„ Ú©Ø³Ø± Ù…ÛŒâ€ŒØ´ÙˆØ¯
     * ÙØ§Ú©ØªÙˆØ± Ø¨Ù‡ PAID ØªØºÛŒÛŒØ± Ù…ÛŒâ€ŒÚ©Ù†Ø¯
   â†“
7. Ú©Ø§Ø±Ø¨Ø± Ø¨Ù‡ ØµÙØ­Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª Ø³ÙØ§Ø±Ø´ Ø¨Ø§Ø²Ù…ÛŒâ€ŒÚ¯Ø±Ø¯Ø¯
```

### 4. TypeScript Types

```typescript
// src/types/index.ts

export interface InvoicePaymentInfo {
  order_id: string;
  invoice_id: string;
  invoice_code: number;
  total_amount: number;
  wallet_balance: number;
  remaining_amount: number;
  can_pay_from_wallet: boolean;
  payment_status: "NOT_PAID" | "PARTIALLY_PAID" | "PAID";
  created_at: string;
}

export interface PayInvoiceFromWalletDto {
  amount?: number;
}

export interface PayInvoiceFromWalletResponse {
  success: boolean;
  message: string;
  payment_id: string;
  remaining_amount: number;
  wallet_balance_after: number;
}

export interface InitiateInvoicePaymentDto {
  amount: number;
  gateway: "zarinpal" | "zibal";
}

export interface InitiateInvoicePaymentResponse {
  payment_transaction_id: string;
  redirect_url: string;
  amount: number;
}

export interface InvoicePaymentCallbackResponse {
  success: boolean;
  message: string;
  ref_id: string;
  invoice_id: string;
  order_id: string;
  amount_paid: number;
  wallet_balance_after: number;
}
```

### 5. API Service Methods

```typescript
// src/services/api.ts

export const invoicePaymentService = {
  getInvoicePaymentInfo: async (
    orderId: string
  ): Promise<InvoicePaymentInfo> => {
    const response = await api.get(`/orders/${orderId}/invoice/payment-info`);
    return response.data;
  },

  payFromWallet: async (
    orderId: string,
    data: PayInvoiceFromWalletDto
  ): Promise<PayInvoiceFromWalletResponse> => {
    const response = await api.post(
      `/orders/${orderId}/invoice/pay-from-wallet`,
      data
    );
    return response.data;
  },

  initiateZarinpalPayment: async (
    invoiceId: string,
    amount: number
  ): Promise<InitiateInvoicePaymentResponse> => {
    const response = await api.post(
      `/payments/invoices/${invoiceId}/gateway/zarinpal`,
      { amount, gateway: "zarinpal" }
    );
    return response.data;
  },

  initiateZibalPayment: async (
    invoiceId: string,
    amount: number
  ): Promise<InitiateInvoicePaymentResponse> => {
    const response = await api.post(
      `/payments/invoices/${invoiceId}/gateway/zibal`,
      { amount, gateway: "zibal" }
    );
    return response.data;
  },

  zarinpalCallback: async (
    invoiceId: string,
    paymentTransactionId: string,
    authority: string,
    status: string
  ): Promise<InvoicePaymentCallbackResponse> => {
    const response = await api.get(
      `/payments/invoices/${invoiceId}/callback/zarinpal`,
      {
        params: {
          payment_transaction_id: paymentTransactionId,
          Authority: authority,
          Status: status,
        },
      }
    );
    return response.data;
  },

  zibalCallback: async (
    invoiceId: string,
    paymentTransactionId: string,
    trackId: number
  ): Promise<InvoicePaymentCallbackResponse> => {
    const response = await api.get(
      `/payments/invoices/${invoiceId}/callback/zibal`,
      {
        params: {
          payment_transaction_id: paymentTransactionId,
          trackId,
        },
      }
    );
    return response.data;
  },
};
```

### 6. UI Components

#### 6.1. ØµÙØ­Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª ÙØ§Ú©ØªÙˆØ±

- Ù…Ø³ÛŒØ±: `/user/orders/{orderId}/invoice/payment`
- Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª ÙØ§Ú©ØªÙˆØ±
- Ù†Ù…Ø§ÛŒØ´ Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©ÛŒÙ Ù¾ÙˆÙ„
- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª

#### 6.2. Callback Page

- Ù…Ø³ÛŒØ±: `/user/orders/{orderId}/invoice/payment/callback`
- Ù†Ù…Ø§ÛŒØ´ Ù†ØªÛŒØ¬Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª
- Ù‡Ø¯Ø§ÛŒØª Ø¨Ù‡ ØµÙØ­Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª Ø³ÙØ§Ø±Ø´

### 7. Ù†Ú©Ø§Øª Ù…Ù‡Ù… Backend

1. **Transaction Safety**: ØªÙ…Ø§Ù… Ø¹Ù…Ù„ÛŒØ§Øª Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ÛŒØ¯ Ø¯Ø± Transaction Ø§Ù†Ø¬Ø§Ù… Ø´ÙˆØ¯
2. **Idempotency**: Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ ØªÚ©Ø±Ø§Ø±ÛŒ Ù†Ø¨Ø§ÛŒØ¯ Ø¨Ø§Ø¹Ø« Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ø¬Ø¯Ø¯ Ø´ÙˆÙ†Ø¯
3. **Wallet Update**: Ø¨Ø¹Ø¯ Ø§Ø² Ù¾Ø±Ø¯Ø§Ø®Øª Ù…ÙˆÙÙ‚ØŒ Ú©ÛŒÙ Ù¾ÙˆÙ„ Ø¨Ø§ÛŒØ¯ Ø¢Ù¾Ø¯ÛŒØª Ø´ÙˆØ¯
4. **Invoice Status**: ÙˆØ¶Ø¹ÛŒØª ÙØ§Ú©ØªÙˆØ± Ø¨Ø§ÛŒØ¯ Ø¨Ù‡ `PAID` ØªØºÛŒÛŒØ± Ú©Ù†Ø¯
5. **Order Status**: Ø§Ú¯Ø± ØªÙ…Ø§Ù… ÙØ§Ú©ØªÙˆØ±Ù‡Ø§ Ù¾Ø±Ø¯Ø§Ø®Øª Ø´Ø¯Ù†Ø¯ØŒ ÙˆØ¶Ø¹ÛŒØª Ø³ÙØ§Ø±Ø´ Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ØªØºÛŒÛŒØ± Ú©Ù†Ø¯
6. **Logging**: ØªÙ…Ø§Ù… ØªØ±Ø§Ú©Ù†Ø´â€ŒÙ‡Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª Ø¨Ø§ÛŒØ¯ Ù„Ø§Ú¯ Ø´ÙˆÙ†Ø¯

### 8. Ø³Ù†Ø§Ø±ÛŒÙˆÙ‡Ø§ÛŒ Edge Case

1. **Ù¾Ø±Ø¯Ø§Ø®Øª Ø¬Ø²Ø¦ÛŒ**: Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø¨Ø®Ø´ÛŒ Ø§Ø² Ù…Ø¨Ù„Øº Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ù†Ø¯
2. **Ù¾Ø±Ø¯Ø§Ø®Øª Ù†Ø§Ù…ÙˆÙÙ‚**: Ø§Ú¯Ø± Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡ Ù†Ø§Ù…ÙˆÙÙ‚ Ø¨Ø§Ø´Ø¯
3. **Timeout**: Ø§Ú¯Ø± Ú©Ø§Ø±Ø¨Ø± Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡ Ø¨Ø±Ù†Ú¯Ø±Ø¯Ø¯
4. **Double Payment**: Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ù¾Ø±Ø¯Ø§Ø®Øª Ù…Ø¬Ø¯Ø¯

### 9. Ø§Ù…Ù†ÛŒØª

1. **Authentication**: Ú©Ø§Ø±Ø¨Ø± Ø¨Ø§ÛŒØ¯ Ù„Ø§Ú¯ÛŒÙ† Ø¨Ø§Ø´Ø¯
2. **Authorization**: Ú©Ø§Ø±Ø¨Ø± ÙÙ‚Ø· Ù…ÛŒâ€ŒØªÙˆØ§Ù†Ø¯ ÙØ§Ú©ØªÙˆØ± Ø®ÙˆØ¯Ø´ Ø±Ø§ Ù¾Ø±Ø¯Ø§Ø®Øª Ú©Ù†Ø¯
3. **Validation**: Ø¨Ø±Ø±Ø³ÛŒ ØµØ­Øª Ù…Ø¨Ù„Øº Ùˆ Ù…ÙˆØ¬ÙˆØ¯ÛŒ
4. **Rate Limiting**: Ù…Ø­Ø¯ÙˆØ¯ Ú©Ø±Ø¯Ù† ØªØ¹Ø¯Ø§Ø¯ Ø¯Ø±Ø®ÙˆØ§Ø³Øªâ€ŒÙ‡Ø§ÛŒ Ù¾Ø±Ø¯Ø§Ø®Øª

## ğŸ“ Ø®Ù„Ø§ØµÙ‡

1. **Endpoint Ø¬Ø¯ÛŒØ¯**: `/orders/{orderId}/invoice/payment-info` Ø¨Ø±Ø§ÛŒ Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª
2. **Endpoint Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„**: `/orders/{orderId}/invoice/pay-from-wallet`
3. **Endpoint Ø¯Ø±Ú¯Ø§Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª**: `/payments/invoices/{invoiceId}/gateway/{gateway}`
4. **Callback Endpoints**: Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²Ú¯Ø´Øª Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡
5. **UI Component**: ØµÙØ­Ù‡ Ù¾Ø±Ø¯Ø§Ø®Øª ÙØ§Ú©ØªÙˆØ±
6. **Integration**: Ø§ØªØµØ§Ù„ Ø¨Ù‡ ØµÙØ­Ù‡ Ø¬Ø²Ø¦ÛŒØ§Øª Ø³ÙØ§Ø±Ø´

Ø§ÛŒÙ† Ø±Ø§Ù‡â€ŒØ­Ù„ Ø§Ù†Ø¹Ø·Ø§Ùâ€ŒÙ¾Ø°ÛŒØ± Ø§Ø³Øª Ùˆ Ù‡Ù… Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ø² Ú©ÛŒÙ Ù¾ÙˆÙ„ Ùˆ Ù‡Ù… Ù¾Ø±Ø¯Ø§Ø®Øª Ø§Ø² Ø¯Ø±Ú¯Ø§Ù‡ Ø±Ø§ Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ù…ÛŒâ€ŒÚ©Ù†Ø¯.
